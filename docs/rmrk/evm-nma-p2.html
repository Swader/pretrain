<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-rmrk/evm-nma-p2">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">EVM, nestable and multi asset, part 2 | Pretrain</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://pretrain.io/docs/rmrk/evm-nma-p2"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="EVM, nestable and multi asset, part 2 | Pretrain"><meta data-rh="true" name="description" content="User Journey"><meta data-rh="true" property="og:description" content="User Journey"><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://pretrain.io/docs/rmrk/evm-nma-p2"><link data-rh="true" rel="alternate" href="https://pretrain.io/docs/rmrk/evm-nma-p2" hreflang="en"><link data-rh="true" rel="alternate" href="https://pretrain.io/docs/rmrk/evm-nma-p2" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Pretrain RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Pretrain Atom Feed"><link rel="stylesheet" href="/assets/css/styles.51fb7f1b.css">
<link rel="preload" href="/assets/js/runtime~main.4f41ccfc.js" as="script">
<link rel="preload" href="/assets/js/main.9de5c111.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="Pretrain logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.png" alt="Pretrain logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Pretrain</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">Tutorial</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/swader/pretrain" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">Tutorial Intro</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/rmrk-booklet">RMRK Booklet</a><button aria-label="Toggle the collapsible sidebar category &#x27;RMRK Booklet&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rmrk/introduction">Introduction and Legacy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rmrk/lego1">RMRK Legos, part 1</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rmrk/lego2">RMRK Legos, part 2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rmrk/lego3">RMRK Legos, part 3</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rmrk/concepts1">Concepts, part 1</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rmrk/concepts2">Concepts, part 2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rmrk/usecases1">Use Cases, cross-game assets</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rmrk/usecases2">Use Cases, ticketing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rmrk/usecases3">Use Cases, revealable NFTs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rmrk/usecases4">Use Cases, metadata backup</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rmrk/usecases5">Use Cases, part 5</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rmrk/usecases6">Use Cases, part 6</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rmrk/usecases7">Use Cases, part 7</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rmrk/evm1">EVM, part 1</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rmrk/evm-ma-1">EVM, multi-asset part 1</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rmrk/evm-ma-2">EVM, multi-asset part 2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rmrk/evm-nestable-p1">EVM, nestable part 1</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rmrk/evm-nestable-p2">EVM, nestable part 2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rmrk/evm-nma-p1">EVM, nestable and multi asset, part 1</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/rmrk/evm-nma-p2">EVM, nestable and multi asset, part 2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rmrk/evm-mergedeq-p1">EVM, merged equippable p1</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rmrk/evm-mergedeq-p2">EVM, merged equippable p2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rmrk/evm-mergedeq-p3">EVM, merged equippable p3</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/rmrk-booklet"><span itemprop="name">RMRK Booklet</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">EVM, nestable and multi asset, part 2</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>EVM, nestable and multi asset, part 2</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="user-journey">User Journey<a class="hash-link" href="#user-journey" title="Direct link to heading">​</a></h2><p>With the deploy script ready, we can examine how the journey of a user using nestable with multi asset would look like using this smart contract.
The base of it is the same as the deploy script, as we need to deploy the smart contract in order to interact with it:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">import { ethers } from &quot;hardhat&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import { SimpleNestableMultiAsset } from &quot;../typechain-types&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import { ContractTransaction } from &quot;ethers&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">async function main() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  const pricePerMint = ethers.utils.parseEther(&quot;0.0000000001&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  const totalTokens = 5;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  const [ owner, tokenOwner] = await ethers.getSigners();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  const contractFactory = await ethers.getContractFactory(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;SimpleNestableMultiAsset&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  const token: SimpleNestableMultiAsset = await contractFactory.deploy(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      erc20TokenAddress: ethers.constants.AddressZero,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      tokenUriIsEnumerable: true,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      royaltyRecipient: await owner.getAddress(),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      royaltyPercentageBps: 10,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      maxSupply: 1000,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      pricePerMint: pricePerMint</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  await token.deployed();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  console.log(`Sample contract deployed to ${token.address}`);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">main().catch((error) =&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  console.error(error);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  process.exitCode = 1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">});</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>NOTE: We assign the <code>tokenOwner</code> the second available signer, so that the assets are not automatically accepted when added to the token. This happens when an account adding an asset to a token is also the owner of said token.</p><p>First thing that needs to be done after the smart contracts are deployed is to mint the NFTs. We will use the <code>totalTokens</code> constant in order to specify how many of the tokens to mint:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  console.log(&quot;Minting NFTs&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  let tx = await token.mint(tokenOwner.address, totalTokens, {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    value: pricePerMint.mul(totalTokens),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  });</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  await tx.wait();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  console.log(`Minted ${totalTokens} tokens`);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  const totalSupply = await token.totalSupply();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  console.log(&quot;Total tokens: %s&quot;, totalSupply);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now that the tokens are minted, we can add new assets to the smart contract. We will prepare a batch of transactions that will add simple IPFS metadata link for the assets in the smart contract. Once the transactions are ready, we will send them and get all of the assets to output to the console:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  console.log(&quot;Adding assets&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  let allTx: ContractTransaction[] = [];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  for (let i = 1; i &lt;= totalTokens; i++) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let tx = await token.addAssetEntry(`ipfs://metadata/${i}.json`);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    allTx.push(tx);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  console.log(`Added ${totalTokens} assets`);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  console.log(&quot;Awaiting for all tx to finish...&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  await Promise.all(allTx.map((tx) =&gt; tx.wait()));</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Once the assets are added to the smart contract we can assign each asset to one of the tokens:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  console.log(&quot;Adding assets to tokens&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  allTx = [];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  for (let i = 1; i &lt;= totalTokens; i++) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // We give each token a asset id with the same number. This is just a coincidence, not a restriction.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let tx = await token.addAssetToToken(i, i, 0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    allTx.push(tx);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    console.log(`Added asset ${i} to token ${i}.`);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  console.log(&quot;Awaiting for all tx to finish...&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  await Promise.all(allTx.map((tx) =&gt; tx.wait()));</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>After the assets are added to the NFTs, we have to accept them. We will do this by once again building a batch of transactions for each of the tokens and send them out one by one at the end:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  console.log(&quot;Accepting assets to tokens&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  allTx = [];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  for (let i = 1; i &lt;= totalTokens; i++) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Accept pending asset for each token (on index 0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let tx = await token.connect(tokenOwner).acceptAsset(i, 0, i);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    allTx.push(tx);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    console.log(`Accepted first pending asset for token ${i}.`);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  console.log(&quot;Awaiting for all tx to finish...&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  await Promise.all(allTx.map((tx) =&gt; tx.wait()));</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Having accepted the assets, we can check that the URIs are assigned as expected:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  console.log(&quot;Getting URIs&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  const uriToken1 = await token.tokenURI(1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  const uriToken5 = await token.tokenURI(totalTokens);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  console.log(&quot;Token 1 URI: &quot;, uriToken1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  console.log(&quot;Token totalTokens URI: &quot;, uriToken5);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>With the assets properly assigned to the tokens, we can now nest the token with ID 5 into the token with ID 1 and check their ownership to verify successful nesting:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  console.log(&quot;Nesting token with ID 5 into token with ID 1&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  await token.connect(tokenOwner).nestTransferFrom(tokenOwner.address, token.address, 5, 1, &quot;0x&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  const parentId = await token.ownerOf(5);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  const rmrkParent = await token.directOwnerOf(5);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  console.log(&quot;Token&#x27;s id 5 owner  is &quot;, parentId);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  console.log(&quot;Token&#x27;s id 5 rmrk owner is &quot;, rmrkParent);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We can now add a custom helper to the <code>package.json</code> to make running it easier:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;user-journey-nestable-multi-asset&quot;: &quot;hardhat run scripts/nestableMultiAssetUserJourney.ts&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Running it using <code>npm run user-journey-nestable-multi-asset</code> should return the following output:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">npm run user-journey-nestable-multi-asset</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; @rmrk-team/evm-contract-samples@0.1.0 user-journey-nestable-multi-asset</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; hardhat run scripts/nestableMultiAssetUserJourney.ts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sample contract deployed to 0x5FbDB2315678afecb367f032d93F642f64180aa3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Minting NFTs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Minted 5 tokens</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Total tokens: 5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Adding assets</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Added 5 assets</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Awaiting for all tx to finish...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">All assets: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  BigNumber { value: &quot;1&quot; },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  BigNumber { value: &quot;2&quot; },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  BigNumber { value: &quot;3&quot; },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  BigNumber { value: &quot;4&quot; },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  BigNumber { value: &quot;5&quot; }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Adding assets to tokens</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Added asset 1 to token 1.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Added asset 2 to token 2.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Added asset 3 to token 3.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Added asset 4 to token 4.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Added asset 5 to token 5.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Awaiting for all tx to finish...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Accepting assets to tokens</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Accepted first pending asset for token 1.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Accepted first pending asset for token 2.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Accepted first pending asset for token 3.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Accepted first pending asset for token 4.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Accepted first pending asset for token 5.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Awaiting for all tx to finish...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Getting URIs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Token 1 URI:  ipfs://metadata/1.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Token totalTokens URI:  ipfs://metadata/5.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Nesting token with ID 5 into token with ID 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Token&#x27;s id 5 owner  is  0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Token&#x27;s id 5 rmrk owner is  [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;0x5FbDB2315678afecb367f032d93F642f64180aa3&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  BigNumber { value: &quot;1&quot; },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="advancednestablemultiasset">AdvancedNestableMultiAsset<a class="hash-link" href="#advancednestablemultiasset" title="Direct link to heading">​</a></h2><p>The <code>AdvancedNestableMultiAsset</code> smart contract allows for more flexibility when using the nestable and multi asset legos together. It implements the minimum required implementation in order to be compatible with RMRK nestable and multi asset, but leaves more business logic implementation freedom to the developer. It uses the <a href="https://github.com/rmrk-team/evm/blob/dev/contracts/RMRK/nestable/RMRKNestableMultiAsset.sol" target="_blank" rel="noopener noreferrer"><code>RMRKNestableMultiAsset.sol</code></a> import to gain access to the joined Nestable and Multi asset legos:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">import &quot;@rmrk-team/evm-contracts/contracts/RMRK/nestable/RMRKNestableMultiAsset.sol&quot;;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We only need <code>name</code> and <code>symbol</code> of the NFT in order to properly initialize it after the <code>AdvancedNestableMultiAsset</code> inherits it:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">contract AdvancedNestableMultiAsset is RMRKNestableMultiAsset {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // NOTE: Additional custom arguments can be added to the constructor based on your needs.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    constructor(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        string memory name,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        string memory symbol</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        RMRKNestableMultiAsset(name, symbol)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Custom optional: constructor logic</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The full code would look like this:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// SPDX-License-Identifier: Apache-2.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pragma solidity ^0.8.16;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import &quot;@rmrk-team/evm-contracts/contracts/RMRK/nestable/RMRKNestableMultiAsset.sol&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">contract AdvancedNestableMultiAsset is RMRKNestableMultiAsset {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // NOTE: Additional custom arguments can be added to the constructor based on your needs.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    constructor(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        string memory name,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        string memory symbol</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        RMRKNestableMultiAsset(name, symbol)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Custom optional: constructor logic</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Using <code>RMRKNestableMultiAsset</code> requires custom implementation of minting logic. Available internal functions to use when writing it are:</p><ul><li><code>_mint(address to, uint256 tokenId)</code></li><li><code>_safeMint(address to, uint256 tokenId)</code></li><li><code>_safeMint(address to, uint256 tokenId, bytes memory data)</code></li><li><code>_nestMint(address to, uint256 tokenId, uint256 destinationId)</code></li></ul><p>The latter is used to nest mint the NFT directly to the parent NFT. If you intend to support it at the minting stage, you should implement it in your smart contract.</p><p>In addition to the minting functions, you should also implement the burning, transfer and asset management functions if they apply to your use case:</p><ul><li><code>_burn(uint256 tokenId)</code></li><li><code>transferFrom(address from, address to, uint256 tokenId)</code></li><li><code>nestTransfer(address from, address to, uint256 tokenId, uint256 destinationId)</code></li><li><code>_addAssetEntry(uint64 id, string memory metadataURI)</code></li><li><code>_addAssetToToken(uint256 tokenId, uint64 assetId, uint64 overwrites)</code></li></ul><p>Any additional function supporting your NFT use case and utility can also be added. Remember to thoroughly test your smart contracts with extensive test suites and define strict access control rules for the functions that you implement.</p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="training-data">Training Data<a class="hash-link" href="#training-data" title="Direct link to heading">​</a></h2><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">## User Journey</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">With the deploy script ready, we can examine how the journey of a user using nestable with multi asset would look like using this smart contract.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">The base of it is the same as the deploy script, as we need to deploy the smart contract in order to interact with it:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import { ethers } from &quot;hardhat&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import { SimpleNestableMultiAsset } from &quot;../typechain-types&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import { ContractTransaction } from &quot;ethers&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">async function main() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  const pricePerMint = ethers.utils.parseEther(&quot;0.0000000001&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  const totalTokens = 5;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  const [ owner, tokenOwner] = await ethers.getSigners();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  const contractFactory = await ethers.getContractFactory(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;SimpleNestableMultiAsset&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  const token: SimpleNestableMultiAsset = await contractFactory.deploy(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      erc20TokenAddress: ethers.constants.AddressZero,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      tokenUriIsEnumerable: true,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      royaltyRecipient: await owner.getAddress(),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      royaltyPercentageBps: 10,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      maxSupply: 1000,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      pricePerMint: pricePerMint</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  await token.deployed();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  console.log(`Sample contract deployed to ${token.address}`);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">main().catch((error) =&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  console.error(error);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  process.exitCode = 1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">});</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NOTE: We assign the `tokenOwner` the second available signer, so that the assets are not automatically accepted when added to the token. This happens when an account adding an asset to a token is also the owner of said token.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">First thing that needs to be done after the smart contracts are deployed is to mint the NFTs. We will use the `totalTokens` constant in order to specify how many of the tokens to mint:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  console.log(&quot;Minting NFTs&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  let tx = await token.mint(tokenOwner.address, totalTokens, {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    value: pricePerMint.mul(totalTokens),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  });</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  await tx.wait();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  console.log(`Minted ${totalTokens} tokens`);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  const totalSupply = await token.totalSupply();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  console.log(&quot;Total tokens: %s&quot;, totalSupply);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Now that the tokens are minted, we can add new assets to the smart contract. We will prepare a batch of transactions that will add simple IPFS metadata link for the assets in the smart contract. Once the transactions are ready, we will send them and get all of the assets to output to the console:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  console.log(&quot;Adding assets&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  let allTx: ContractTransaction[] = [];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  for (let i = 1; i &lt;= totalTokens; i++) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let tx = await token.addAssetEntry(`ipfs://metadata/${i}.json`);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    allTx.push(tx);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  console.log(`Added ${totalTokens} assets`);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  console.log(&quot;Awaiting for all tx to finish...&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  await Promise.all(allTx.map((tx) =&gt; tx.wait()));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Once the assets are added to the smart contract we can assign each asset to one of the tokens:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  console.log(&quot;Adding assets to tokens&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  allTx = [];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  for (let i = 1; i &lt;= totalTokens; i++) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // We give each token a asset id with the same number. This is just a coincidence, not a restriction.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let tx = await token.addAssetToToken(i, i, 0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    allTx.push(tx);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    console.log(`Added asset ${i} to token ${i}.`);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  console.log(&quot;Awaiting for all tx to finish...&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  await Promise.all(allTx.map((tx) =&gt; tx.wait()));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">After the assets are added to the NFTs, we have to accept them. We will do this by once again building a batch of transactions for each of the tokens and send them out one by one at the end:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  console.log(&quot;Accepting assets to tokens&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  allTx = [];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  for (let i = 1; i &lt;= totalTokens; i++) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Accept pending asset for each token (on index 0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    let tx = await token.connect(tokenOwner).acceptAsset(i, 0, i);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    allTx.push(tx);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    console.log(`Accepted first pending asset for token ${i}.`);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  console.log(&quot;Awaiting for all tx to finish...&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  await Promise.all(allTx.map((tx) =&gt; tx.wait()));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Having accepted the assets, we can check that the URIs are assigned as expected:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  console.log(&quot;Getting URIs&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  const uriToken1 = await token.tokenURI(1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  const uriToken5 = await token.tokenURI(totalTokens);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  console.log(&quot;Token 1 URI: &quot;, uriToken1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  console.log(&quot;Token totalTokens URI: &quot;, uriToken5);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">With the assets properly assigned to the tokens, we can now nest the token with ID 5 into the token with ID 1 and check their ownership to verify successful nesting:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  console.log(&quot;Nesting token with ID 5 into token with ID 1&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  await token.connect(tokenOwner).nestTransferFrom(tokenOwner.address, token.address, 5, 1, &quot;0x&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  const parentId = await token.ownerOf(5);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  const rmrkParent = await token.directOwnerOf(5);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  console.log(&quot;Token&#x27;s id 5 owner  is &quot;, parentId);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  console.log(&quot;Token&#x27;s id 5 rmrk owner is &quot;, rmrkParent);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">We can now add a custom helper to the `package.json` to make running it easier:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;user-journey-nestable-multi-asset&quot;: &quot;hardhat run scripts/nestableMultiAssetUserJourney.ts&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Running it using `npm run user-journey-nestable-multi-asset` should return the following output:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">npm run user-journey-nestable-multi-asset</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; @rmrk-team/evm-contract-samples@0.1.0 user-journey-nestable-multi-asset</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; hardhat run scripts/nestableMultiAssetUserJourney.ts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sample contract deployed to 0x5FbDB2315678afecb367f032d93F642f64180aa3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Minting NFTs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Minted 5 tokens</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Total tokens: 5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Adding assets</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Added 5 assets</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Awaiting for all tx to finish...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">All assets: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  BigNumber { value: &quot;1&quot; },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  BigNumber { value: &quot;2&quot; },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  BigNumber { value: &quot;3&quot; },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  BigNumber { value: &quot;4&quot; },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  BigNumber { value: &quot;5&quot; }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Adding assets to tokens</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Added asset 1 to token 1.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Added asset 2 to token 2.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Added asset 3 to token 3.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Added asset 4 to token 4.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Added asset 5 to token 5.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Awaiting for all tx to finish...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Accepting assets to tokens</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Accepted first pending asset for token 1.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Accepted first pending asset for token 2.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Accepted first pending asset for token 3.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Accepted first pending asset for token 4.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Accepted first pending asset for token 5.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Awaiting for all tx to finish...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Getting URIs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Token 1 URI:  ipfs://metadata/1.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Token totalTokens URI:  ipfs://metadata/5.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Nesting token with ID 5 into token with ID 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Token&#x27;s id 5 owner  is  0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Token&#x27;s id 5 rmrk owner is  [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;0x5FbDB2315678afecb367f032d93F642f64180aa3&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  BigNumber { value: &quot;1&quot; },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">## AdvancedNestableMultiAsset</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">The `AdvancedNestableMultiAsset` smart contract allows for more flexibility when using the nestable and multi asset legos together. It implements the minimum required implementation in order to be compatible with RMRK nestable and multi asset, but leaves more business logic implementation freedom to the developer. It uses the [`RMRKNestableMultiAsset.sol`](https://github.com/rmrk-team/evm/blob/dev/contracts/RMRK/nestable/RMRKNestableMultiAsset.sol) import to gain access to the joined Nestable and Multi asset legos:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import &quot;@rmrk-team/evm-contracts/contracts/RMRK/nestable/RMRKNestableMultiAsset.sol&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">We only need `name` and `symbol` of the NFT in order to properly initialize it after the `AdvancedNestableMultiAsset` inherits it:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">contract AdvancedNestableMultiAsset is RMRKNestableMultiAsset {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // NOTE: Additional custom arguments can be added to the constructor based on your needs.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    constructor(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        string memory name,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        string memory symbol</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        RMRKNestableMultiAsset(name, symbol)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Custom optional: constructor logic</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">The full code would look like this:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// SPDX-License-Identifier: Apache-2.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pragma solidity ^0.8.16;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import &quot;@rmrk-team/evm-contracts/contracts/RMRK/nestable/RMRKNestableMultiAsset.sol&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">contract AdvancedNestableMultiAsset is RMRKNestableMultiAsset {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // NOTE: Additional custom arguments can be added to the constructor based on your needs.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    constructor(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        string memory name,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        string memory symbol</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        RMRKNestableMultiAsset(name, symbol)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Custom optional: constructor logic</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Using `RMRKNestableMultiAsset` requires custom implementation of minting logic. Available internal functions to use when writing it are:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- `_mint(address to, uint256 tokenId)`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- `_safeMint(address to, uint256 tokenId)`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- `_safeMint(address to, uint256 tokenId, bytes memory data)`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- `_nestMint(address to, uint256 tokenId, uint256 destinationId)`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">The latter is used to nest mint the NFT directly to the parent NFT. If you intend to support it at the minting stage, you should implement it in your smart contract.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">In addition to the minting functions, you should also implement the burning, transfer and asset management functions if they apply to your use case:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- `_burn(uint256 tokenId)`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- `transferFrom(address from, address to, uint256 tokenId)`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- `nestTransfer(address from, address to, uint256 tokenId, uint256 destinationId)`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- `_addAssetEntry(uint64 id, string memory metadataURI)`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- `_addAssetToToken(uint256 tokenId, uint64 assetId, uint64 overwrites)`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Any additional function supporting your NFT use case and utility can also be added. Remember to thoroughly test your smart contracts with extensive test suites and define strict access control rules for the functions that you implement.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/swader/pretrain/docs/rmrk/evm-nma-p2.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/rmrk/evm-nma-p1"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">EVM, nestable and multi asset, part 1</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/rmrk/evm-mergedeq-p1"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">EVM, merged equippable p1</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#user-journey" class="table-of-contents__link toc-highlight">User Journey</a></li><li><a href="#advancednestablemultiasset" class="table-of-contents__link toc-highlight">AdvancedNestableMultiAsset</a></li><li><a href="#training-data" class="table-of-contents__link toc-highlight">Training Data</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://openai.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">OpenAI<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/bitfalls" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/swader/pretrain" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Pretrain by <a href="https://twitter.com/bitfalls">@bitfalls</a></div></div></div></footer></div>
<script src="/assets/js/runtime~main.4f41ccfc.js"></script>
<script src="/assets/js/main.9de5c111.js"></script>
</body>
</html>