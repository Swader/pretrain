<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-rmrk/evm-mergedeq-p3">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">EVM, merged equippable p3 | Pretrain</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://pretrain.io/docs/rmrk/evm-mergedeq-p3"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="EVM, merged equippable p3 | Pretrain"><meta data-rh="true" name="description" content="Adding assets to Gems is done in the addGemAssets. It accepts Gem, address of the Kanaria smart contract and the address of the Catalog smart contract. We will add 4 assets for each gem; one full version and three that match each slot. Reference IDs are specified for easier reference from the child&#x27;s perspective. The assets will be added one by one. Note how the full versions of gems don&#x27;t have the equippableGroupId."><meta data-rh="true" property="og:description" content="Adding assets to Gems is done in the addGemAssets. It accepts Gem, address of the Kanaria smart contract and the address of the Catalog smart contract. We will add 4 assets for each gem; one full version and three that match each slot. Reference IDs are specified for easier reference from the child&#x27;s perspective. The assets will be added one by one. Note how the full versions of gems don&#x27;t have the equippableGroupId."><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://pretrain.io/docs/rmrk/evm-mergedeq-p3"><link data-rh="true" rel="alternate" href="https://pretrain.io/docs/rmrk/evm-mergedeq-p3" hreflang="en"><link data-rh="true" rel="alternate" href="https://pretrain.io/docs/rmrk/evm-mergedeq-p3" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Pretrain RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Pretrain Atom Feed"><link rel="stylesheet" href="/assets/css/styles.51fb7f1b.css">
<link rel="preload" href="/assets/js/runtime~main.6cd981a3.js" as="script">
<link rel="preload" href="/assets/js/main.a6940d4d.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="Pretrain logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.png" alt="Pretrain logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Pretrain</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">Tutorial</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/swader/pretrain" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">Tutorial Intro</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/rmrk-booklet">RMRK Booklet</a><button aria-label="Toggle the collapsible sidebar category &#x27;RMRK Booklet&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rmrk/introduction">Introduction and Legacy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rmrk/lego1">RMRK Legos, part 1</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rmrk/lego2">RMRK Legos, part 2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rmrk/lego3">RMRK Legos, part 3</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rmrk/concepts1">Concepts, part 1</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rmrk/concepts2">Concepts, part 2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rmrk/usecases1">Use Cases, cross-game assets</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rmrk/usecases2">Use Cases, ticketing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rmrk/usecases3">Use Cases, revealable NFTs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rmrk/usecases4">Use Cases, metadata backup</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rmrk/usecases5">Use Cases, part 5</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rmrk/usecases6">Use Cases, part 6</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rmrk/usecases7">Use Cases, part 7</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rmrk/evm1">EVM, part 1</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rmrk/evm-ma-1">EVM, multi-asset part 1</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rmrk/evm-ma-2">EVM, multi-asset part 2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rmrk/evm-nestable-p1">EVM, nestable part 1</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rmrk/evm-nestable-p2">EVM, nestable part 2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rmrk/evm-nma-p1">EVM, nestable and multi asset, part 1</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rmrk/evm-nma-p2">EVM, nestable and multi asset, part 2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rmrk/evm-mergedeq-p1">EVM, merged equippable p1</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rmrk/evm-mergedeq-p2">EVM, merged equippable p2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/rmrk/evm-mergedeq-p3">EVM, merged equippable p3</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/rmrk-booklet"><span itemprop="name">RMRK Booklet</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">EVM, merged equippable p3</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>EVM, merged equippable p3</h1><p>Adding assets to <code>Gem</code>s is done in the <code>addGemAssets</code>. It accepts <code>Gem</code>, address of the <code>Kanaria</code> smart contract and the address of the <code>Catalog</code> smart contract. We will add 4 assets for each gem; one full version and three that match each slot. Reference IDs are specified for easier reference from the child&#x27;s perspective. The assets will be added one by one. Note how the full versions of gems don&#x27;t have the <code>equippableGroupId</code>.</p><p>Having added the asset entries, we can now add the valid parent reference IDs using the <code>setValidParentForEquippableGroup</code>. For example if we want to add a valid reference for the left gem, we need to pass the value of equippable reference ID of the left gem, parent smart contract address (in our case this is Kanaria smart contract) and ID of the slot which was defined in Catalog (this is ID number 9 in the Catalog for the left gem).</p><p>Last thing to do is to add assets to the tokens using <a href="https://github.com/rmrk-team/evm-dev-docs/blob/master/rmrk-legos-examples/broken-reference/README.md" target="_blank" rel="noopener noreferrer"><code>addAssetToToken</code></a>. Asset of type A will be added to the gems 1 and 2, and the type B of the asset is added to gem 3. All of these should be accepted using <code>acceptAsset</code>:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">async function addGemAssets(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  gem: SimpleEquippable,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  kanariaAddress: string,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  catalogAddress: string</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">): Promise&lt;void&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  console.log(&quot;Adding Gem assets&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  const [ , tokenOwner] = await ethers.getSigners();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // We&#x27;ll add 4 assets for each gem, a full version and 3 versions matching each slot.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // We will have only 2 types of gems -&gt; 4x2: 8 assets.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // This is not composed by others, so fixed and slot parts are never used.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  const gemVersions = 4;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // These refIds are used from the child&#x27;s perspective, to group assets that can be equipped into a parent</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // With it, we avoid the need to do set it asset by asset</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  const equippableRefIdLeftGem = 1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  const equippableRefIdMidGem = 2;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  const equippableRefIdRightGem = 3;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // We can do a for loop, but this makes it clearer.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  console.log(&quot;Adding asset entries&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  let allTx = [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  let allTx = [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await gem.addEquippableAssetEntry(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      // Full version for first type of gem, no need of refId or catalog</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      catalogAddress,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      `ipfs://gems/typeA/full.svg`,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      []</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await gem.addEquippableAssetEntry(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      // Equipped into left slot for first type of gem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      equippableRefIdLeftGem,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      catalogAddress,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      `ipfs://gems/typeA/left.svg`,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      []</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await gem.addEquippableAssetEntry(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      // Equipped into mid slot for first type of gem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      equippableRefIdMidGem,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      catalogAddress,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      `ipfs://gems/typeA/mid.svg`,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      []</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await gem.addEquippableAssetEntry(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      // Equipped into left slot for first type of gem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      equippableRefIdRightGem,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      catalogAddress,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      `ipfs://gems/typeA/right.svg`,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      []</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await gem.addEquippableAssetEntry(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      // Full version for second type of gem, no need of refId or catalog</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      ethers.constants.AddressZero,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      `ipfs://gems/typeB/full.svg`,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      []</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await gem.addEquippableAssetEntry(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      // Equipped into left slot for second type of gem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      equippableRefIdLeftGem,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      catalogAddress,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      `ipfs://gems/typeB/left.svg`,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      []</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await gem.addEquippableAssetEntry(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      // Equipped into mid slot for second type of gem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      equippableRefIdMidGem,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      catalogAddress,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      `ipfs://gems/typeB/mid.svg`,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      []</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await gem.addEquippableAssetEntry(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      // Equipped into right slot for second type of gem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      equippableRefIdRightGem,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      catalogAddress,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      `ipfs://gems/typeB/right.svg`,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      []</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  await Promise.all(allTx.map((tx) =&gt; tx.wait()));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  console.log(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;Added 8 gem assets. 2 Types of gems with full, left, mid and right versions.&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // 9, 10 and 11 are the slot part ids for the gems, defined on the catalog.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // e.g. Any asset on gem, which sets its equippableRefId to equippableRefIdLeftGem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //      will be considered a valid equip into any kanaria on slot 9 (left gem).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  console.log(&quot;Setting valid parent reference IDs&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  allTx = [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await gem.setValidParentForEquippableGroup(equippableRefIdLeftGem, kanariaAddress, 9),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await gem.setValidParentForEquippableGroup(equippableRefIdMidGem, kanariaAddress, 10),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await gem.setValidParentForEquippableGroup(equippableRefIdRightGem, kanariaAddress, 11),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  await Promise.all(allTx.map((tx) =&gt; tx.wait()));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // We add assets of type A to gem 1 and 2, and type B to gem 3. Both are nested into the first kanaria</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // This means gems 1 and 2 will have the same asset, which is totally valid.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  console.log(&quot;Add assets to tokens&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  allTx = [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await gem.addAssetToToken(1, 1, 0),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await gem.addAssetToToken(1, 2, 0),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await gem.addAssetToToken(1, 3, 0),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await gem.addAssetToToken(1, 4, 0),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await gem.addAssetToToken(2, 1, 0),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await gem.addAssetToToken(2, 2, 0),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await gem.addAssetToToken(2, 3, 0),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await gem.addAssetToToken(2, 4, 0),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await gem.addAssetToToken(3, 5, 0),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await gem.addAssetToToken(3, 6, 0),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await gem.addAssetToToken(3, 7, 0),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await gem.addAssetToToken(3, 8, 0),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  await Promise.all(allTx.map((tx) =&gt; tx.wait()));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  console.log(&quot;Added 4 assets to each of 3 gems.&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// We accept each asset for all gems</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  allTx = [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await gem.connect(tokenOwner).acceptAsset(1, 3, 4),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await gem.connect(tokenOwner).acceptAsset(1, 2, 3),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await gem.connect(tokenOwner).acceptAsset(1, 1, 2),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await gem.connect(tokenOwner).acceptAsset(1, 0, 1),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await gem.connect(tokenOwner).acceptAsset(2, 3, 4),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await gem.connect(tokenOwner).acceptAsset(2, 2, 3),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await gem.connect(tokenOwner).acceptAsset(2, 1, 2),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await gem.connect(tokenOwner).acceptAsset(2, 0, 1),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await gem.connect(tokenOwner).acceptAsset(3, 3, 8),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await gem.connect(tokenOwner).acceptAsset(3, 2, 7),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await gem.connect(tokenOwner).acceptAsset(3, 1, 6),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await gem.connect(tokenOwner).acceptAsset(3, 0, 5),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  await Promise.all(allTx.map((tx) =&gt; tx.wait()));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  console.log(&quot;Accepted 4 assets to each of 3 gems.&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In order for the <code>addKanariaAssets</code> and <code>addGemAssets</code> to be called, we have to add them to the <code>main</code> function:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  await addKanariaAssets(kanaria, catalog.address);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  await addGemAssets(gem, kanaria.address, catalog.address);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>With <code>Kanaria</code>s and <code>Gem</code>s ready, we can equip the gems to Kanarias using the <code>equipGems</code> function. We will build a batch of equip transactions and then send them one after the other:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">async function equipGems(kanaria: SimpleEquippable): Promise&lt;void&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  console.log(&quot;Equipping gems&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  const [ , tokenOwner] = await ethers.getSigners();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  const allTx = [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await kanaria.connect(tokenOwner).equip({</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      tokenId: 1, // Kanaria 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      childIndex: 2, // Gem 1 is on position 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      assetId: 2, // Asset for the kanaria which is composable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      slotPartId: 9, // left gem slot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      childAssetId: 2, // Asset id for child meant for the left gem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await kanaria.connect(tokenOwner).equip({</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      tokenId: 1, // Kanaria 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      childIndex: 1, // Gem 2 is on position 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      assetId: 2, // Asset for the kanaria which is composable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      slotPartId: 10, // mid gem slot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      childAssetId: 3, // Asset id for child meant for the mid gem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await kanaria.connect(tokenOwner).equip({</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      tokenId: 1, // Kanaria 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      childIndex: 0, // Gem 3 is on position 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      assetId: 2, // Asset for the kanaria which is composable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      slotPartId: 11, // right gem slot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      childAssetId: 8, // Asset id for child meant for the right gem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  await Promise.all(allTx.map((tx) =&gt; tx.wait()));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  console.log(&quot;Equipped 3 gems into first kanaria&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In order for the <code>equipGems</code> to be called, we have to add it to the <code>main</code> function:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  await equipGems(kanaria);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Last thing to do is to compose the equippables with the <code>composeEquippables</code> function. It composes the whole NFT along with the nested and equipped parts:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">async function composeEquippables(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  views: RMRKEquipRenderUtils,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  kanariaAddress: string</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">): Promise&lt;void&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  console.log(&quot;Composing equippables&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  const tokenId = 1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  const assetId = 2;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  console.log(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;Composed: &quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await views.composeEquippables(kanariaAddress, tokenId, assetId)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>NOTE: Using RMRKEquipRenderUtils is not required for Equippable to work, it just provides a dedicated utility for easier viewing of the full composites.</p><p>In order for the <code>composeEquippables</code> to be called, we have to add it to the <code>main</code> function:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  await composeEquippables(views, kanaria.address);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Instead of deploying the smart contracts, we can also retrieve the already deployed ones and use those in it. To do that, we can define the addresses of the smart contracts below the <code>import</code> statements:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">const deployedKanariaAddress = &quot;&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">const deployedGemAddress = &quot;&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">const deployedCatalogAddress = &quot;&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">const deployedViewsAddress = &quot;&quot;;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>A function to retrieve the smart contracts is called <code>retrieveContracts</code> and it only loads the contract factories and attaches them to the already deployed smart contracts:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">async function retrieveContracts(): Promise&lt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  [SimpleEquippable, SimpleEquippable, SimpleCatalog, RMRKEquipRenderUtils]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  const contractFactory = await ethers.getContractFactory(&quot;SimpleEquippable&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  const catalogFactory = await ethers.getContractFactory(&quot;SimpleCatalog&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  const viewsFactory = await ethers.getContractFactory(&quot;RMRKEquipRenderUtils&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  const kanaria: SimpleEquippable = contractFactory.attach(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    deployedKanariaAddress</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  const gem: SimpleEquippable = contractFactory.attach(deployedGemAddress);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  const catalog: SimpleCatalog = catalogFactory.attach(deployedCatalogAddress);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  const views: RMRKEquipRenderUtils = await viewsFactory.attach(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    deployedViewsAddress</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  return [kanaria, gem, catalog, views];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In order to use it, replace the call to the <code>deployContracts</code> at the beginning of the main function with the <code>retrieveContracts</code>.</p><p>With the user journey script concluded, we can add a custom helper to the <code>package.json</code> to make running it easier:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;user-journey-merged-equippable&quot;: &quot;hardhat run scripts/mergedEquippableUserJourney.ts&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You can run it using <code>npm run user-journey-merged-equippable</code>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="advanced-mergedequippable">Advanced MergedEquippable<a class="hash-link" href="#advanced-mergedequippable" title="Direct link to heading"></a></h2><p>Uses the <code>AdvancedCatalog</code> and <code>AdvancedEquippable</code> and allows for more flexibility when implementing the Merged equippable RMRK lego. It implements the minimum required implementation in order to be compatible with RMRK merged equippable, but leaves more business logic implementation freedom to the developer.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="advancedcatalog">AdvancedCatalog<a class="hash-link" href="#advancedcatalog" title="Direct link to heading"></a></h3><p>The <code>AdvancedCatalog</code> smart contract uses the <a href="https://github.com/rmrk-team/evm/blob/dev/contracts/RMRK/catalog/RMRKCatalog.sol" target="_blank" rel="noopener noreferrer">RMRKCatalog.sol</a> import to gain access to the Catalog lego:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">import &quot;@rmrk-team/evm-contracts/contracts/RMRK/catalog/RMRKCatalog.sol&quot;;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We only need <code>symbol</code> and <code>type_</code> of the catalog in order to properly initialize it after the AdvancedCatalog inherits it:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">contract AdvancedCatalog is RMRKCatalog {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // NOTE: Additional custom arguments can be added to the constructor based on your needs.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    constructor(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        string memory symbol,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        string memory type_</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        RMRKCatalog(symbol, type_)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Custom optional: constructor logic</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The full code is thus:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// SPDX-License-Identifier: Apache-2.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pragma solidity ^0.8.16;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import &quot;@rmrk-team/evm-contracts/contracts/RMRK/catalog/RMRKCatalog.sol&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">contract AdvancedCatalog is RMRKCatalog {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // NOTE: Additional custom arguments can be added to the constructor based on your needs.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    constructor(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        string memory symbol,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        string memory type_</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        RMRKCatalog(symbol, type_)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Custom optional: constructor logic</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Using RMRKCatalog requires custom implementation of part management. Available internal functions to use when writing it are:</p><ul><li><code>_addPart(IntakeStruct memory intakeStruct)</code></li><li><code>_addPartList(IntakeStruct[] memory intakeStructs)</code></li></ul><p>In addition to the part management functions, you should also implement the equippable management function with the following internal ones available:</p><ul><li><code>_addEquippableAddresses(uint64 partId, address[] memory equippableAddresses)</code></li><li><code>_setEquippableAddresses( uint64 partId, address[] memory equippableAddresses)</code></li><li><code>_setEquippableToAll(uint64 partId)</code></li><li><code>_resetEquippableAddresses(uint64 partId)</code></li></ul><p>Any additional functions supporting your NFT use case and utility related to the Catalog RMRK lego can also be added.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="advancedequippable">AdvancedEquippable<a class="hash-link" href="#advancedequippable" title="Direct link to heading"></a></h3><p>AdvancedEquippable uses the <a href="https://github.com/rmrk-team/evm/blob/dev/contracts/RMRK/equippable/RMRKEquippable.sol" target="_blank" rel="noopener noreferrer"><code>RMRKEquippable.sol</code></a> import to gain access to the Merged equippable RMRK lego composite:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">import &quot;@rmrk-team/evm-contracts/contracts/RMRK/equippable/RMRKEquippable.sol&quot;;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We only need <code>name</code> and <code>symbol</code> of the NFT collection in order to properly initialize it after the AdvancedEquippable inherits it:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">contract AdvancedEquippable is RMRKEquippable {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // NOTE: Additional custom arguments can be added to the constructor based on your needs.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    constructor(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        string memory name,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        string memory symbol</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        RMRKEquippable(name, symbol)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Custom optional: constructor logic</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This is all that is required to get you started with implementing the Merged equippable RMRK lego composite.</p><p>Using RMRKEquippable requires custom implementation of minting logic. Available internal functions to use when writing it are:</p><ul><li><code>_mint(address to, uint256 tokenId)</code></li><li><code>_safeMint(address to, uint256 tokenId)</code></li><li><code>_safeMint(address to, uint256 tokenId, bytes memory data)</code></li><li><code>_nestMint(address to, uint256 tokenId, uint256 destinationId, bytes memory data)</code></li></ul><p>The latter is used to mint a child NFT directly into the parent NFT, so implement it if you foresee it applies to your use case. Additionally burning and transfer functions can be implemented using:</p><ul><li><code>_burn(uint256 tokenId, uint256 maxChildrenBurns)</code></li><li><code>transferFrom(address from, address to, uint256 tokenId)</code></li><li><code>nestTransferFrom(address from, address to, uint256 tokenId, uint256 destinationId, bytes memory data)</code></li></ul><p>Asset and reference management functions should also be implemented using:</p><ul><li><code>_addEquippableAssetEntry(uint64 id, uint64 equippableGroupId, address baseAddress, string memory metadataURI, uint64[] calldata partIds)</code></li><li><code>_addAssetToToken(uint256 tokenId, uint64 assetId, uint64 replacesAssetWithId)</code></li><li><code>_setValidParentForEquippableGroup(uint64 equippableGroupId, address parentAddress, uint64 slotPartId)</code></li></ul><p>Any additional functions supporting your NFT use case and utility can also be added.</p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="training-data">Training Data<a class="hash-link" href="#training-data" title="Direct link to heading"></a></h2><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">## Advanced MergedEquippable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">The Advanced MergedEquippable implementation uses the `AdvancedCatalog` and `AdvancedEquippable` and allows for more flexibility when implementing the Merged equippable RMRK lego. It implements the minimum required implementation in order to be compatible with RMRK merged equippable, but leaves more business logic implementation freedom to the developer.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">### AdvancedCatalog</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">The `AdvancedCatalog` smart contract represents the minimum required implementation in order for the smart contract to be compatible with the `Catalog` RMRK lego. It uses the [RMRKCatalog.sol](https://github.com/rmrk-team/evm/blob/dev/contracts/RMRK/catalog/RMRKCatalog.sol) import to gain access to the Catalog lego:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import &quot;@rmrk-team/evm-contracts/contracts/RMRK/catalog/RMRKCatalog.sol&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">We only need `symbol` and `type_` of the catalog in order to properly initialize it after the AdvancedCatalog inherits it:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">contract AdvancedCatalog is RMRKCatalog {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // NOTE: Additional custom arguments can be added to the constructor based on your needs.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    constructor(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        string memory symbol,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        string memory type_</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        RMRKCatalog(symbol, type_)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Custom optional: constructor logic</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">The full code is thus:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// SPDX-License-Identifier: Apache-2.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pragma solidity ^0.8.16;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import &quot;@rmrk-team/evm-contracts/contracts/RMRK/catalog/RMRKCatalog.sol&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">contract AdvancedCatalog is RMRKCatalog {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // NOTE: Additional custom arguments can be added to the constructor based on your needs.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    constructor(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        string memory symbol,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        string memory type_</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        RMRKCatalog(symbol, type_)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Custom optional: constructor logic</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Using RMRKCatalog requires custom implementation of part management. Available internal functions to use when writing it are:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- `_addPart(IntakeStruct memory intakeStruct)`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- `_addPartList(IntakeStruct[] memory intakeStructs)`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">In addition to the part management functions, you should also implement the equippable management function with the following internal ones available:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- `_addEquippableAddresses(uint64 partId, address[] memory equippableAddresses)`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- `_setEquippableAddresses( uint64 partId, address[] memory equippableAddresses)`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- `_setEquippableToAll(uint64 partId)`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- `_resetEquippableAddresses(uint64 partId)`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Any additional functions supporting your NFT use case and utility related to the Catalog RMRK lego can also be added. Remember to thoroughly test your smart contracts with extensive test suites and define strict access control rules for the functions that you implement.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">### AdvancedEquippable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">The AdvancedEquippable smart contract represents the minimum required implementation in order for the smart contract to be compatible with the MergedEquippable RMRK lego composite. It uses the [`RMRKEquippable.sol`](https://github.com/rmrk-team/evm/blob/dev/contracts/RMRK/equippable/RMRKEquippable.sol) import to gain access to the Merged equippable RMRK lego composite:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import &quot;@rmrk-team/evm-contracts/contracts/RMRK/equippable/RMRKEquippable.sol&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">We only need `name` and `symbol` of the NFT collection in order to properly initialize it after the AdvancedEquippable inherits it:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">contract AdvancedEquippable is RMRKEquippable {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // NOTE: Additional custom arguments can be added to the constructor based on your needs.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    constructor(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        string memory name,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        string memory symbol</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        RMRKEquippable(name, symbol)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Custom optional: constructor logic</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">This is all that is required to get you started with implementing the Merged equippable RMRK lego composite.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// SPDX-License-Identifier: Apache-2.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pragma solidity ^0.8.16;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import &quot;@rmrk-team/evm-contracts/contracts/RMRK/equippable/RMRKEquippable.sol&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">contract AdvancedEquippable is RMRKEquippable {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // NOTE: Additional custom arguments can be added to the constructor based on your needs.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    constructor(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        string memory name,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        string memory symbol</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        RMRKEquippable(name, symbol)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Custom optional: constructor logic</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Using RMRKEquippable requires custom implementation of minting logic. Available internal functions to use when writing it are:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- `_mint(address to, uint256 tokenId)`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- `_safeMint(address to, uint256 tokenId)`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- `_safeMint(address to, uint256 tokenId, bytes memory data)`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- `_nestMint(address to, uint256 tokenId, uint256 destinationId, bytes memory data)`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">The latter is used to mint a child NFT directly into the parent NFT, so implement it if you foresee it applies to your use case. Additionally burning and transfer functions can be implemented using:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- `_burn(uint256 tokenId, uint256 maxChildrenBurns)`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- `transferFrom(address from, address to, uint256 tokenId)`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- `nestTransferFrom(address from, address to, uint256 tokenId, uint256 destinationId, bytes memory data)`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Asset and reference management functions should also be implemented using:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- `_addEquippableAssetEntry(uint64 id, uint64 equippableGroupId, address baseAddress, string memory metadataURI, uint64[] calldata partIds)`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- `_addAssetToToken(uint256 tokenId, uint64 assetId, uint64 replacesAssetWithId)`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- `_setValidParentForEquippableGroup(uint64 equippableGroupId, address parentAddress, uint64 slotPartId)`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Any additional functions supporting your NFT use case and utility can also be added. Remember to thoroughly test your smart contracts with extensive test suites and define strict access control rules for the functions that you implement.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="training-data-1">Training Data<a class="hash-link" href="#training-data-1" title="Direct link to heading"></a></h2><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Adding assets to `Gem`s is done in the `addGemAssets`. It accepts `Gem`, address of the `Kanaria` smart contract and the address of the `Catalog` smart contract. We will add 4 assets for each gem; one full version and three that match each slot. Reference IDs are specified for easier reference from the child&#x27;s perspective. The assets will be added one by one. Note how the full versions of gems don&#x27;t have the `equippableGroupId`.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Having added the asset entries, we can now add the valid parent reference IDs using the `setValidParentForEquippableGroup`. For example if we want to add a valid reference for the left gem, we need to pass the value of equippable reference ID of the left gem, parent smart contract address (in our case this is Kanaria smart contract) and ID of the slot which was defined in Catalog (this is ID number 9 in the Catalog for the left gem).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Last thing to do is to add assets to the tokens using [`addAssetToToken`](https://github.com/rmrk-team/evm-dev-docs/blob/master/rmrk-legos-examples/broken-reference/README.md). Asset of type A will be added to the gems 1 and 2, and the type B of the asset is added to gem 3. All of these should be accepted using `acceptAsset`:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">async function addGemAssets(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  gem: SimpleEquippable,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  kanariaAddress: string,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  catalogAddress: string</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">): Promise&lt;void&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  console.log(&quot;Adding Gem assets&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  const [ , tokenOwner] = await ethers.getSigners();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // We&#x27;ll add 4 assets for each gem, a full version and 3 versions matching each slot.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // We will have only 2 types of gems -&gt; 4x2: 8 assets.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // This is not composed by others, so fixed and slot parts are never used.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  const gemVersions = 4;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // These refIds are used from the child&#x27;s perspective, to group assets that can be equipped into a parent</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // With it, we avoid the need to do set it asset by asset</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  const equippableRefIdLeftGem = 1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  const equippableRefIdMidGem = 2;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  const equippableRefIdRightGem = 3;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // We can do a for loop, but this makes it clearer.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  console.log(&quot;Adding asset entries&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  let allTx = [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  let allTx = [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await gem.addEquippableAssetEntry(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      // Full version for first type of gem, no need of refId or catalog</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      catalogAddress,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      `ipfs://gems/typeA/full.svg`,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      []</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await gem.addEquippableAssetEntry(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      // Equipped into left slot for first type of gem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      equippableRefIdLeftGem,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      catalogAddress,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      `ipfs://gems/typeA/left.svg`,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      []</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await gem.addEquippableAssetEntry(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      // Equipped into mid slot for first type of gem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      equippableRefIdMidGem,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      catalogAddress,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      `ipfs://gems/typeA/mid.svg`,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      []</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await gem.addEquippableAssetEntry(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      // Equipped into left slot for first type of gem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      equippableRefIdRightGem,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      catalogAddress,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      `ipfs://gems/typeA/right.svg`,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      []</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await gem.addEquippableAssetEntry(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      // Full version for second type of gem, no need of refId or catalog</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      ethers.constants.AddressZero,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      `ipfs://gems/typeB/full.svg`,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      []</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await gem.addEquippableAssetEntry(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      // Equipped into left slot for second type of gem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      equippableRefIdLeftGem,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      catalogAddress,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      `ipfs://gems/typeB/left.svg`,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      []</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await gem.addEquippableAssetEntry(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      // Equipped into mid slot for second type of gem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      equippableRefIdMidGem,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      catalogAddress,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      `ipfs://gems/typeB/mid.svg`,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      []</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await gem.addEquippableAssetEntry(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      // Equipped into right slot for second type of gem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      equippableRefIdRightGem,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      catalogAddress,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      `ipfs://gems/typeB/right.svg`,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      []</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  await Promise.all(allTx.map((tx) =&gt; tx.wait()));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  console.log(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;Added 8 gem assets. 2 Types of gems with full, left, mid and right versions.&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // 9, 10 and 11 are the slot part ids for the gems, defined on the catalog.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // e.g. Any asset on gem, which sets its equippableRefId to equippableRefIdLeftGem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //      will be considered a valid equip into any kanaria on slot 9 (left gem).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  console.log(&quot;Setting valid parent reference IDs&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  allTx = [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await gem.setValidParentForEquippableGroup(equippableRefIdLeftGem, kanariaAddress, 9),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await gem.setValidParentForEquippableGroup(equippableRefIdMidGem, kanariaAddress, 10),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await gem.setValidParentForEquippableGroup(equippableRefIdRightGem, kanariaAddress, 11),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  await Promise.all(allTx.map((tx) =&gt; tx.wait()));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // We add assets of type A to gem 1 and 2, and type B to gem 3. Both are nested into the first kanaria</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // This means gems 1 and 2 will have the same asset, which is totally valid.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  console.log(&quot;Add assets to tokens&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  allTx = [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await gem.addAssetToToken(1, 1, 0),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await gem.addAssetToToken(1, 2, 0),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await gem.addAssetToToken(1, 3, 0),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await gem.addAssetToToken(1, 4, 0),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await gem.addAssetToToken(2, 1, 0),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await gem.addAssetToToken(2, 2, 0),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await gem.addAssetToToken(2, 3, 0),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await gem.addAssetToToken(2, 4, 0),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await gem.addAssetToToken(3, 5, 0),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await gem.addAssetToToken(3, 6, 0),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await gem.addAssetToToken(3, 7, 0),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await gem.addAssetToToken(3, 8, 0),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  await Promise.all(allTx.map((tx) =&gt; tx.wait()));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  console.log(&quot;Added 4 assets to each of 3 gems.&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// We accept each asset for all gems</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  allTx = [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await gem.connect(tokenOwner).acceptAsset(1, 3, 4),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await gem.connect(tokenOwner).acceptAsset(1, 2, 3),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await gem.connect(tokenOwner).acceptAsset(1, 1, 2),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await gem.connect(tokenOwner).acceptAsset(1, 0, 1),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await gem.connect(tokenOwner).acceptAsset(2, 3, 4),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await gem.connect(tokenOwner).acceptAsset(2, 2, 3),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await gem.connect(tokenOwner).acceptAsset(2, 1, 2),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await gem.connect(tokenOwner).acceptAsset(2, 0, 1),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await gem.connect(tokenOwner).acceptAsset(3, 3, 8),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await gem.connect(tokenOwner).acceptAsset(3, 2, 7),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await gem.connect(tokenOwner).acceptAsset(3, 1, 6),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await gem.connect(tokenOwner).acceptAsset(3, 0, 5),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  await Promise.all(allTx.map((tx) =&gt; tx.wait()));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  console.log(&quot;Accepted 4 assets to each of 3 gems.&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">In order for the `addKanariaAssets` and `addGemAssets` to be called, we have to add them to the `main` function:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  await addKanariaAssets(kanaria, catalog.address);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  await addGemAssets(gem, kanaria.address, catalog.address);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">With `Kanaria`s and `Gem`s ready, we can equip the gems to Kanarias using the `equipGems` function. We will build a batch of equip transactions and then send them one after the other:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">async function equipGems(kanaria: SimpleEquippable): Promise&lt;void&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  console.log(&quot;Equipping gems&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  const [ , tokenOwner] = await ethers.getSigners();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  const allTx = [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await kanaria.connect(tokenOwner).equip({</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      tokenId: 1, // Kanaria 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      childIndex: 2, // Gem 1 is on position 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      assetId: 2, // Asset for the kanaria which is composable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      slotPartId: 9, // left gem slot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      childAssetId: 2, // Asset id for child meant for the left gem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await kanaria.connect(tokenOwner).equip({</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      tokenId: 1, // Kanaria 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      childIndex: 1, // Gem 2 is on position 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      assetId: 2, // Asset for the kanaria which is composable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      slotPartId: 10, // mid gem slot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      childAssetId: 3, // Asset id for child meant for the mid gem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await kanaria.connect(tokenOwner).equip({</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      tokenId: 1, // Kanaria 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      childIndex: 0, // Gem 3 is on position 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      assetId: 2, // Asset for the kanaria which is composable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      slotPartId: 11, // right gem slot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      childAssetId: 8, // Asset id for child meant for the right gem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  await Promise.all(allTx.map((tx) =&gt; tx.wait()));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  console.log(&quot;Equipped 3 gems into first kanaria&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">In order for the `equipGems` to be called, we have to add it to the `main` function:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  await equipGems(kanaria);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Last thing to do is to compose the equippables with the `composeEquippables` function. It composes the whole NFT along with the nested and equipped parts:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">async function composeEquippables(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  views: RMRKEquipRenderUtils,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  kanariaAddress: string</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">): Promise&lt;void&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  console.log(&quot;Composing equippables&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  const tokenId = 1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  const assetId = 2;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  console.log(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;Composed: &quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await views.composeEquippables(kanariaAddress, tokenId, assetId)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NOTE: Using RMRKEquipRenderUtils is not required for Equippable to work, it just provides a dedicated utility for easier viewing of the full composites.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">In order for the `composeEquippables` to be called, we have to add it to the `main` function:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  await composeEquippables(views, kanaria.address);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Instead of deploying the smart contracts, we can also retrieve the already deployed ones and use those in it. To do that, we can define the addresses of the smart contracts below the `import` statements:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">const deployedKanariaAddress = &quot;&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">const deployedGemAddress = &quot;&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">const deployedCatalogAddress = &quot;&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">const deployedViewsAddress = &quot;&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">A function to retrieve the smart contracts is called `retrieveContracts` and it only loads the contract factories and attaches them to the already deployed smart contracts:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">async function retrieveContracts(): Promise&lt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  [SimpleEquippable, SimpleEquippable, SimpleCatalog, RMRKEquipRenderUtils]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  const contractFactory = await ethers.getContractFactory(&quot;SimpleEquippable&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  const catalogFactory = await ethers.getContractFactory(&quot;SimpleCatalog&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  const viewsFactory = await ethers.getContractFactory(&quot;RMRKEquipRenderUtils&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  const kanaria: SimpleEquippable = contractFactory.attach(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    deployedKanariaAddress</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  const gem: SimpleEquippable = contractFactory.attach(deployedGemAddress);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  const catalog: SimpleCatalog = catalogFactory.attach(deployedCatalogAddress);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  const views: RMRKEquipRenderUtils = await viewsFactory.attach(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    deployedViewsAddress</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  return [kanaria, gem, catalog, views];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">In order to use it, replace the call to the `deployContracts` at the beginning of the main function with the `retrieveContracts`.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">With the user journey script concluded, we can add a custom helper to the `package.json` to make running it easier:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;user-journey-merged-equippable&quot;: &quot;hardhat run scripts/mergedEquippableUserJourney.ts&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">You can run it using `npm run user-journey-merged-equippable`.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">## Advanced MergedEquippable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Uses the `AdvancedCatalog` and `AdvancedEquippable` and allows for more flexibility when implementing the Merged equippable RMRK lego. It implements the minimum required implementation in order to be compatible with RMRK merged equippable, but leaves more business logic implementation freedom to the developer.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">### AdvancedCatalog</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">The `AdvancedCatalog` smart contract uses the [RMRKCatalog.sol](https://github.com/rmrk-team/evm/blob/dev/contracts/RMRK/catalog/RMRKCatalog.sol) import to gain access to the Catalog lego:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import &quot;@rmrk-team/evm-contracts/contracts/RMRK/catalog/RMRKCatalog.sol&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">We only need `symbol` and `type_` of the catalog in order to properly initialize it after the AdvancedCatalog inherits it:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">contract AdvancedCatalog is RMRKCatalog {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // NOTE: Additional custom arguments can be added to the constructor based on your needs.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    constructor(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        string memory symbol,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        string memory type_</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        RMRKCatalog(symbol, type_)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Custom optional: constructor logic</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">The full code is thus:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// SPDX-License-Identifier: Apache-2.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pragma solidity ^0.8.16;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import &quot;@rmrk-team/evm-contracts/contracts/RMRK/catalog/RMRKCatalog.sol&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">contract AdvancedCatalog is RMRKCatalog {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // NOTE: Additional custom arguments can be added to the constructor based on your needs.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    constructor(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        string memory symbol,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        string memory type_</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        RMRKCatalog(symbol, type_)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Custom optional: constructor logic</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Using RMRKCatalog requires custom implementation of part management. Available internal functions to use when writing it are:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- `_addPart(IntakeStruct memory intakeStruct)`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- `_addPartList(IntakeStruct[] memory intakeStructs)`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">In addition to the part management functions, you should also implement the equippable management function with the following internal ones available:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- `_addEquippableAddresses(uint64 partId, address[] memory equippableAddresses)`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- `_setEquippableAddresses( uint64 partId, address[] memory equippableAddresses)`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- `_setEquippableToAll(uint64 partId)`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- `_resetEquippableAddresses(uint64 partId)`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Any additional functions supporting your NFT use case and utility related to the Catalog RMRK lego can also be added.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">### AdvancedEquippable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AdvancedEquippable uses the [`RMRKEquippable.sol`](https://github.com/rmrk-team/evm/blob/dev/contracts/RMRK/equippable/RMRKEquippable.sol) import to gain access to the Merged equippable RMRK lego composite:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import &quot;@rmrk-team/evm-contracts/contracts/RMRK/equippable/RMRKEquippable.sol&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">We only need `name` and `symbol` of the NFT collection in order to properly initialize it after the AdvancedEquippable inherits it:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">contract AdvancedEquippable is RMRKEquippable {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // NOTE: Additional custom arguments can be added to the constructor based on your needs.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    constructor(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        string memory name,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        string memory symbol</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        RMRKEquippable(name, symbol)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Custom optional: constructor logic</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">This is all that is required to get you started with implementing the Merged equippable RMRK lego composite.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Using RMRKEquippable requires custom implementation of minting logic. Available internal functions to use when writing it are:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- `_mint(address to, uint256 tokenId)`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- `_safeMint(address to, uint256 tokenId)`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- `_safeMint(address to, uint256 tokenId, bytes memory data)`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- `_nestMint(address to, uint256 tokenId, uint256 destinationId, bytes memory data)`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">The latter is used to mint a child NFT directly into the parent NFT, so implement it if you foresee it applies to your use case. Additionally burning and transfer functions can be implemented using:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- `_burn(uint256 tokenId, uint256 maxChildrenBurns)`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- `transferFrom(address from, address to, uint256 tokenId)`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- `nestTransferFrom(address from, address to, uint256 tokenId, uint256 destinationId, bytes memory data)`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Asset and reference management functions should also be implemented using:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- `_addEquippableAssetEntry(uint64 id, uint64 equippableGroupId, address baseAddress, string memory metadataURI, uint64[] calldata partIds)`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- `_addAssetToToken(uint256 tokenId, uint64 assetId, uint64 replacesAssetWithId)`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- `_setValidParentForEquippableGroup(uint64 equippableGroupId, address parentAddress, uint64 slotPartId)`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Any additional functions supporting your NFT use case and utility can also be added.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/swader/pretrain/docs/rmrk/evm-mergedeq-p3.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/rmrk/evm-mergedeq-p2"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">EVM, merged equippable p2</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#advanced-mergedequippable" class="table-of-contents__link toc-highlight">Advanced MergedEquippable</a><ul><li><a href="#advancedcatalog" class="table-of-contents__link toc-highlight">AdvancedCatalog</a></li><li><a href="#advancedequippable" class="table-of-contents__link toc-highlight">AdvancedEquippable</a></li></ul></li><li><a href="#training-data" class="table-of-contents__link toc-highlight">Training Data</a></li><li><a href="#training-data-1" class="table-of-contents__link toc-highlight">Training Data</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://openai.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">OpenAI<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/bitfalls" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/swader/pretrain" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright  2023 Pretrain by <a href="https://twitter.com/bitfalls">@bitfalls</a></div></div></div></footer></div>
<script src="/assets/js/runtime~main.6cd981a3.js"></script>
<script src="/assets/js/main.a6940d4d.js"></script>
</body>
</html>